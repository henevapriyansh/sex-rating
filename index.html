<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Kiss Me & I'll Rate You ðŸ’‹</title>
  <style>
    body {
      margin:0; padding:0; height:100vh; background:#ffebef;
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      touch-action: manipulation;
      overflow:hidden;
    }
    #lips {
      width: 280px; height: 180px;
      background: radial-gradient(ellipse at center, #ff3b7a 0%, #c31450 70%);
      border-radius: 0 0 140px 140px / 0 0 90px 90px;
      position: relative;
      box-shadow: inset 0 -20px 30px rgba(0,0,0,0.3), 0 10px 20px rgba(0,0,0,0.4);
      overflow: hidden;
    }
    #lips::before {
      content:""; position:absolute; top:30px; left:50%; transform:translateX(-50%);
      width:140px; height:20px; background:rgba(255,255,255,0.4);
      border-radius:50%;
    }
    #score {
      margin-top:30px; font-size:28px; font-weight:bold; color:#c31450;
      min-height:40px;
    }
    #details { margin-top:20px; font-size:18px; color:#333; text-align:center; }
    #start { margin-bottom:30px; font-size:24px; color:#c31450; }
    .heart { font-size:50px; animation: pulse 1.5s infinite; }
    @keyframes pulse { 0%,100% {transform:scale(1)} 50% {transform:scale(1.3)} }
  </style>
</head>
<body>

  <div id="start">ðŸ‘† Kiss the lips ðŸ‘†</div>

  <div id="lips"></div>

  <div id="score"></div>
  <div id="details"></div>

  <script>
    const lips = document.getElementById('lips');
    const scoreEl = document.getElementById('score');
    const detailsEl = document.getElementById('details');
    const startEl = document.getElementById('start');

    let touches = [];
    let startTime = 0;
    let maxTouches = 0;
    let totalPressure = 0;
    let pressureSamples = 0;
    let kissCount = 0;
    let lastUpTime = 0;

    function isInsideLips(x, y) {
      const rect = lips.getBoundingClientRect();
      const cx = rect.left + rect.width / 2;
      const cy = rect.top + rect.height / 2;
      const dx = (x - cx) / (rect.width / 2);
      const dy = (y - cy) / (rect.height * 0.9);
      return (dx * dx + dy * dy) <= 1;
    }

    function rateKiss() {
      const duration = (Date.now() - startTime) / 1000;
      const avgPressure = pressureSamples > 0 ? totalPressure / pressureSamples : 0.5;

      // Detect multiple quick kisses (pecks) vs long passionate ones
      const isLongKiss = duration > 3;
      const passion = Math.min(100,
        (maxTouches * 20) +
        (duration * 8) +
        (avgPressure * 40) +
        (touches.length * 0.1)
      );

      let rating = "";
      let emoji = "";

      if (kissCount >= 5 && duration < 4) {
        rating = "Peck Monster ðŸ˜˜ðŸ˜˜ðŸ˜˜";
        emoji = "ðŸ˜˜ðŸ˜˜ðŸ˜˜ðŸ˜˜ðŸ˜˜";
      } else if (passion > 90) {
        rating = "HOLY FIREWORKS!! ðŸ”¥ðŸ’‹";
        emoji = "ðŸ’¥â¤ï¸â€ðŸ”¥";
      } else if (passion > 75) {
        rating = "French-Level Passionate ðŸ’‹";
        emoji = "ðŸ¥µðŸ’œ";
      } else if (passion > 60) {
        rating = "Very Naughty ðŸ˜";
        emoji = "ðŸ˜ˆðŸ’‹";
      } else if (passion > 40) {
        rating = "Sweet & Loving â¤ï¸";
        emoji = "ðŸ¥°";
      } else if (passion > 20) {
        rating = "Shy First Kiss ðŸŒ¸";
        emoji = "ðŸ˜Š";
      } else {
        rating = "Butterfly Kiss ðŸ¦‹";
        emoji = "ðŸ˜š";
      }

      scoreEl.innerHTML = `<div class="heart">${emoji}</div>${rating}`;
      detailsEl.innerHTML = `
        Kisses: ${kissCount}<br>
        Longest kiss: ${duration.toFixed(1)}s<br>
        Max fingers: ${maxTouches}<br>
        Passion score: ${passion.toFixed(0)}/100
      `;
    }

    lips.addEventListener('touchstart', e => {
      e.preventDefault();
      const validTouches = Array.from(e.touches).filter(t => isInsideLips(t.clientX, t.clientY));

      if (validTouches.length > 0) {
        if (startTime === 0 || Date.now() - lastUpTime > 800) {
          // new kiss started
          if (startTime !== 0) kissCount++;
          startTime = Date.now();
          touches = [];
        }
        maxTouches = Math.max(maxTouches, validTouches.length);
        validTouches.forEach(t => {
          touches.push({x: t.clientX, y: t.clientY});
          if (t.force !== undefined) {
            totalPressure += t.force;
            pressureSamples++;
          }
        });
        startEl.style.display = 'none';
      }
    }, {passive: false});

    lips.addEventListener('touchend', e => {
      if (startTime !== 0 && e.touches.length === 0) {
        lastUpTime = Date.now();
        setTimeout(() => {
          if (Date.now() - lastUpTime >= 1000) {
            rateKiss();
            // reset for next kiss
            startTime = 0; maxTouches = 0; totalPressure = 0; pressureSamples = 0;
            setTimeout(() => {
              scoreEl.textContent = '';
              detailsEl.textContent = '';
              startEl.style.display = 'block';
            }, 4000);
          }
        }, 1200);
      }
    });
  </script>
</body>
</html>
